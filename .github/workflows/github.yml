name: github
on: [push, pull_request]
jobs:
  install:
    name: install
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2.4.0
      - name: Install dependencies
        run: |
          if [ -e package-lock.json ]; then
          npm ci
          else
          npm i
          fi
  build:
    name: build
    runs-on: ${{matrix.os}}
    needs:
      - install
    strategy:
      matrix:
        os: [ ubuntu-latest ]
    steps:
      - name: Checkout
        uses: actions/checkout@v2.4.0
      - name: Linting
        run: npm run lint
      - name: Remove previous build
        run: npm run prebuild
      - name: Build frontend files
        run: npm run build:frontend
      - name: Build backend files
        run: npm run build:backend
  release:
    name: release
    runs-on: ubuntu-latest
    if: ${{ github.ref == 'refs/heads/main' }}
    needs:
      - build
    steps:
      - name: Checkout
        uses: actions/checkout@v2.4.0
